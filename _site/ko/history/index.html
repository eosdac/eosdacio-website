<!DOCTYPE html>
<html lang="ko"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    
      eosDAC | The Community-Owned EOS Block Producer and DAC Enabler
    
  </title>
  <meta property="og:title" content="eosDAC">
  <meta property="og:site_name" content="eosDAC">
  <meta name="description" content="The Community-Owned EOS Block Producer and DAC Enabler">
  <meta property="og:description" content="The Community-Owned EOS Block Producer and DAC Enabler">
  <link rel="shortcut icon" type="image/png" href="/assets/favicon.png?1554394469">
  <link href="/assets/styles.css?1554394469s" rel="stylesheet">
  <link href="https://vjs.zencdn.net/7.4.1/video-js.css" rel="stylesheet">
  <link rel="stylesheet" href="/assets/videojs-resolution-switcher.css">
  <link rel="stylesheet"
    href="https://unpkg.com/bootstrap-material-design@4.1.1/dist/css/bootstrap-material-design.min.css"
    integrity="sha384-wXznGJNEXNG1NFsbm0ugrLFMQPWswR3lds2VeinahP8N0zJw9VWSopbjv2x7WCvX"
    crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/bootstrap-material-design-overwrite.css?1554394469">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:100,200,300,400,500,600">
  <link rel="stylesheet" href="/assets/main.css?1554394469">
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="crossorigin="anonymous"></script><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/ko/feed.xml" title="site.title" /><link rel="prefetch" href="/assets/why-join/join-and-sign-consti_480p.mp4">
  <link rel="prefetch" href="/assets/why-join/interact-with-discord-1_480p.mp4">
  <link rel="prefetch" href="/assets/why-join/interact-with-discord-2_480p.mp4">
  <link rel="prefetch" href="/assets/why-join/voting-custodians_480p.mp4">
  <link rel="prefetch" href="/assets/why-join/join-and-sign-consti.mp4">
  <link rel="prefetch" href="/assets/why-join/interact-with-discord-1.mp4">
  <link rel="prefetch" href="/assets/why-join/interact-with-discord-2.mp4">
  <link rel="prefetch" href="/assets/why-join/voting-custodians.mp4">
</head>
<body><header class="site-header" role="banner" style="border:0">
  <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark nav-tabs"
    style="background-image:linear-gradient(to right, #4A1289, #7C41BA)">
    <a class="navbar-brand" href="/ko/">
      <img src="/assets/signet-white.svg" height="42" alt="eosDAC">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse"
      data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
      aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav mr-auto">
        
        
        <li class="nav-item"><a class="nav-link" href="/ko/why-vote/">
            Why Vote for eosDAC?</a></li>
        
        
        
        <li class="nav-item"><a class="nav-link" href="/ko/why-join/">
            Why Join eosDAC?</a></li>
        
        
        
        <li class="nav-item"><a class="nav-link" href="/ko/why-launch/">
            Why Launch a DAC?</a></li>
        
        
        
        <li class="nav-item"><a class="nav-link" href="/ko/community/">
            Community</a></li>
        
        
        
        <li class="nav-item"><a class="nav-link" href="/ko/token/">
            Token</a></li>
        
        
        
        <li class="nav-item"><a class="nav-link" href="/ko/tools/">
            Tools</a></li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <li class="nav-item"><a class="nav-link" href="/ko/news/index.html">
            News</a></li>
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown"
            role="button" data-toggle="dropdown" aria-haspopup="true"
            aria-expanded="false">
            <img src="/assets/flags/ko.png" />
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            
            
            
            
            <a class="dropdown-item" href="/history/">
              <img src="/assets/flags/en.png" />&nbsp;English
            </a>
            
            
            
             
            
            
            
            <a class="dropdown-item" href="/zh-hans/history/">
              <img src="/assets/flags/zh-hans.png" />&nbsp;简体中文
            </a>
            
            
            
            
            
            
            <a class="dropdown-item" href="/vi/history/">
              <img src="/assets/flags/vi.png" />&nbsp;Tiếng Việt
            </a>
            
            
            
            
            
            
            <a class="dropdown-item" href="/ja/history/">
              <img src="/assets/flags/ja.png" />&nbsp;日本語
            </a>
            
            
            
            
            
            
            <a class="dropdown-item" href="/es/history/">
              <img src="/assets/flags/es.png" />&nbsp;Español
            </a>
            
            
            
            
            
            
            <a class="dropdown-item" href="/ru/history/">
              <img src="/assets/flags/ru.png" />&nbsp;Pусский
            </a>
            
            
            
          </div>
        </li>
      </ul>
      <span class="navbar-text nav-buttons">
        <a href="/ko/why-vote/#voting-matters" class="btn solid light btn-raised scatter-vote-oneclick">
          Vote eosdacserver
        </a>
        <a href="/ko/member-client/" class="btn outline light btn-raised">
          Member Client
        </a>
      </span>
    </div>
  </nav>
</header>
<main class="page-content main" style="padding:0;" aria-label="Content">
      <div class="">
        <div class="history">
<div class="section head dark">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h1 id="eosdac-연혁">eos<strong>DAC 연혁</strong></h1>

<p>2018년 3월 eosDAC은 커뮤니티 소유 EOS 블록 프로듀서로서 등장하여 <em>EOS.IO 블록 생산은 원하는 누구나 기여할 수 있고 이익을 얻을 수 있도록 개방되어야 한다는 비전을 세웠습니다.</em></p>

      </div>
    </div>
  </div>
</div>

<div class="section">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h1 id="eosdac-inception">eos<strong>DAC Inception</strong></h1>

<p>EOS 커뮤니티 자체가 소유하는 EOS 블록 프로듀서를 실현하기 위해 eosDAC은 eosDAC 토큰의 75%를 EOS 토큰 홀더에게, 20%는 론칭 팀과 자문 및 커뮤니티 구축에 분배되었고 나머지 5%의 eosDAC 토큰은 eosDAC Ltd에 제공되었으며, 예비자금으로 사용됩니다.</p>

<p>포스트 자세히 읽기(영문): <a href="https://steemit.com/eos/@eosdac/introducing-eosdac-the-community-owned-eos-block-producer">https://steemit.com/eos/@eosdac/introducing-eosdac-the-community-owned-eos-block-producer</a></p>

<p>같은 달 말에 eosDAC은 서버 인프라와 론칭 팀에 대한 간략한 소개와 함께 EOSio 블록 프로듀서 후보로서의 소개를 담은 블록 프로듀서 출마를 발표했습니다.</p>

<p>eosDAC 블록 프로듀서 후보 공지문 읽기(영문): <a href="https://steemit.com/eos/@eosdac/eosdac-block-producer-candidate-information">https://steemit.com/eos/@eosdac/eosdac-block-producer-candidate-information</a></p>

<h1 id="블록-생산을-넘어---dac들의-협력체">블록 생산을 넘어 - DAC들의 협력체</h1>

<p>2014년, 다니엘 라리머가 탈중앙 자유화 커뮤니티(Decentralized Autonomous Communities, 약칭 “DACs”)이라는 개념을 도입했습니다. 그리고 이 개념을 실현하기 위해 다니엘 라리머와 브렌단 블루머가 모여 블록원(Block.one)이라는 이름 아래 EOS 소프트웨어를 개발했습니다. 블록원은 초창기 발표를 통해 EOS.IO 소프트웨어가 ‘DAC의 시대’를 불러올 거라고 했습니다. 기존의 회사 개념에 비해 DAC은 훨씬 더 투명성 있고, 감사하기 쉬우며 신뢰성 있고 또 포용적이라고 설명하며 이로 인해 DAC이 훨씬 더 경쟁력 있는 구조라는 것을 역설했습니다.</p>

<p>eosDAC 역시 이와 같은 비전을 갖고 있습니다. 탈중앙 자유화 커뮤니티들이 전통적인 사업의 판도를 바꾸어 놓을 것이라고 믿는 것입니다. 이런 혁신적인 비즈니스 모델이 ‘회사’란 무엇인가에 대한 우리의 인식을 바꿀 것입니다. 블록체인 기술은 사람과 환경에서 자원을 가져다 쓰기만 하는 것이 아니라, 가치를 창출한 뒤 이를 커뮤니티에 돌려주는 새로운 형태의 비즈니스를 가능하게 합니다. DAC과 관련된 모든 이해집단은 지속적으로 가치를 창출할 이유가 생기는 셈이고, 따라서 DAC이 계속하고 성장할 원동력이 됩니다.</p>

<p>DAC을 운영하려면 여러 툴이 필요하지만 아직 이런 툴이 없는 실정입니다. eosDAC은 이런 다양한 툴을 만들 것이며, 이 소프트웨어를 오픈 소스로 공유할 것입니다. 따라서 DAC을 설립하여 운영하고자 하는 누구나 DAC 툴킷을 무료로 사용할 수 있을 것입니다.</p>

<p>이 DAC 툴킷은 시간이 지나면서 조직적으로 발전할 것이며 가장 핵심적인 멤버십, 투표, 관리인 및 제안(서) 등의 개념을 포함합니다. DAC 토큰을 보유한 모든 계정으로 회원이 될 수 있으며 회원에게는 DAC에서 이익을 추구할 권리, 관리인로 나설 자격, 관리인를 투표할 권리 및 제안서를 제출할 권한이 주어집니다. 관리인들은 DAC의 의사 결정권자입니다. 회원들의 투표로 지명되며 따라서 회원들을 대표하고 회원들을 위해 지속적으로 투표를 해야 합니다. 관리인들은 제안에 대해 회원들을 대표해 투표를 하며 이런 절차를 거쳐 승인된 제안은 (자금이 허락하는 한에 있어서) 시행되고, 확인되며 보상을 지급하게 됩니다. 모든 제안은 발전 과정의 결과물로 DAC 생태계에 긍정적인 영향을 미칠 것입니다.</p>

<p>DAC을 기계에 비유한다면, DAC 툴킷이 위와 같은 모든 수레바퀴를 잘 맞물려서 돌아가게 하는 역할을 한다고 볼 수 있을 것입니다.</p>

<p><img src="/assets/history/dac-enabler.png" alt="DAC 협력체" /></p>

<p>향후 다른 DAC 구조와 툴 역시 지원할 수 있을 것입니다. 다른 개인, 단체 및 DAC들도 이 툴킷을 기반으로 설립을 할 수 있도록 구상 중에 있습니다. 이 툴킷은 단순히 소프트웨어만이 아니라 다른 관할권/사법권에 따른 법률 및 규제 가이드와 모범 운영 정책 및 eosDAC의 시도에 대한 케이스 스터디까지 포함됩니다.</p>

<p>eosDAC은 DAC들이 전 세계의 법률 및 금융 제도, 아니 새로운 DAC의 설립과 번창에 필요한 모든 것과 상호작용할 수 있는 일종의 ‘규격화’된 구조를 만들기 위해 지속적으로 노력할 것입니다.</p>

<h1 id="ethereum-네트워크-상의-에어드롭-완료-및-토큰-소각">Ethereum 네트워크 상의 에어드롭 완료 및 토큰 소각</h1>

<p>eosDAC은 2018년 5월 15일 eosDAC 토큰 에어드롭을 마쳤으며 EOS 홀더에게 에어드롭되지 않은 토큰은 소각되었습니다.</p>

<p><img src="/assets/history/token-burn.png" alt="토큰 소각" /></p>

<p><strong>238,080,898.455</strong> 토큰이 소각되었습니다. 이 토큰은 복구 불가능한 Ethereum 계정0x0000000000000000000000000000000000e05dac으로 보내졌습니다.</p>

<p>이로 인해 총 eosDAC의 총 유통량은 <strong>961 919 101.545</strong>입니다.</p>

<p>에어드롭 완료 및 소각에 대한 자세한 정보는 이 안내문을 참고해 주십시오: <a href="https://steemkr.com/eos/@eosdac/2vdmsj-eosdac">https://steemkr.com/eos/@eosdac/2vdmsj-eosdac</a></p>

<p>이후 에어드롭을 지원하는 일부 거래소와 1개의 개인 계좌가 소각량에 포함되었다는 것이 확인되었습니다. 많은 논의 끝에 eosDAC 토큰을 EOS 네트워크로 스왑하면서 이러한 토큰 역시 스왑량에 포함하기로 결정했습니다. EOS 체인으로 eosDAC 토큰을 전환할 때 언급한 지갑을 포함하는 것에 대한 안내문은 다음에서 확인하실 수 있습니다.
<a href="https://steemit.com/eos/@eosdac/statement-on-inclusion-of-specific-exchange-wallets-in-the-eosdac-token-transition-to-the-eos-chain">https://steemit.com/eos/@eosdac/statement-on-inclusion-of-specific-exchange-wallets-in-the-eosdac-token-transition-to-the-eos-chain</a></p>

<h1 id="eos-메인넷-출범-및-보안에-대한-eosdac의-기여도">EOS 메인넷 출범 및 보안에 대한 eosDAC의 기여도</h1>
<p>eosDAC는 EOS Rio, HKEOS, Sw/eden, EOS Tribe, EOS 42 등과 함께 Ghostbusters팀의 일원이었습니다.</p>

<h2 id="ghostbusters-팀에-대해서-간략히-소개해-드리겠습니다">Ghostbusters 팀에 대해서 간략히 소개해 드리겠습니다.</h2>

<p>Ghostbusters의 시작은 가능한 한 보안을 높이며 eosio 소프트웨어를 실행하는 모범 사례를 연구하고 연습하는 데 중점을 둔 EOS 테스트넷이었습니다. 인프라 보안에 대해 초점이 부족했던 점에 대한 우려로 시작되었습니다. 따라서 런칭을 하자는 의도가 아닌 연구 환경으로 시작되었으며, 이는 곧 보안에 대한 우리의 시각과 의견을 같이하는 커뮤니티 및 다른 BPC의 관심을 끌었습니다. 그 후 사람들은 이를 런칭 방식으로 추천하게 된 것입니다.</p>

<p>eosDAC의 마이클 예이츠(Micheal Yeates)는 개발자 대상으로 진행된 EOS 버그 바운티에서 10000 EOS에 상당하는 DDOS 버그를 찾은 바 있습니다. 공격자가 노드 CPU의 100%를 사용할 수 있게 하는 버그였고 마이클이 보고한 후 수정되었습니다.
<a href="https://twitter.com/eosdac/status/1005154586188009473">https://twitter.com/eosdac/status/1005154586188009473</a></p>

<p>eosDAC 기술 팀은 셀 수 없이 오랜 시간 다른 BPC들과 끊임없이 줌콜 회의에 참여하였으며, 수개월간 커뮤니티 테스트넷에서 EOSIO 소프트웨어 테스팅, 또 수주 간 메인넷의 안전한 출범을 위해 잠자는 시간까지 희생하며 노력했습니다.</p>

<h1 id="토큰-스왑">토큰 스왑</h1>

<p>메인넷을 성공적으로 런칭한 후, eosDAC은 6월 셋째 주에 토큰 스왑을 완료했습니다.</p>

<p>토큰 스왑 결과는 다음과 같습니다.</p>
<ol>
  <li>총 공급량 - <strong>994,895,254.98</strong>
    <ul>
      <li>에어드롭된 토큰 - <strong>987896341.6</strong></li>
      <li>DEX 계약에 묶인 토큰 -  <strong>4,473,804.66</strong></li>
      <li>폴백 실패 - <strong>2,525,108.71</strong></li>
    </ul>
  </li>
  <li>소각한 토큰 총량 <strong>205097655.6</strong></li>
</ol>

<p>eosDAC은 Forkdelta 및 Idex와 같은 DEX 계약에 묶인 토큰과 폴백을 생성할 수 없는 토큰을 복구하기 위해 최선을 다할 것입니다.
자세한 내역 보고서: <a href="https://docs.google.com/document/d/1irdLXCz4yJqdLPAeG2EgLGvyQAlXZ-DivU0i-PTTKBY/edit">https://docs.google.com/document/d/1irdLXCz4yJqdLPAeG2EgLGvyQAlXZ-DivU0i-PTTKBY/edit</a></p>

<h1 id="dac-팩토리와-object-computing과의-파트너십에-중점을-두다">DAC 팩토리와 Object Computing과의 파트너십에 중점을 두다</h1>

<p>토큰 배포를 완료한 후 eosDAC의 주요 초점은 DAC 팩토리였습니다. eosDAC은 Block.One의 EOS 개발을 도운 업계 최고 팀인 OCI(https://objectcomputing.com/)와 파트너십을 매었습니다. OCI는 eosDAC의 스마트 계약 코드 검토를 돕고 있으며 DAC 툴킷의 진행을 가속화하기 위해 기술 팀과 긴밀히 협력하고 있습니다.</p>

<p>더 읽기: <a href="https://steemit.com/eos/@eosdac/eosdac-accelerates-progress-on-dac-toolkit-partners-with-object-computing">https://steemit.com/eos/@eosdac/eosdac-accelerates-progress-on-dac-toolkit-partners-with-object-computing</a>
불과 며칠 전 eosDAC은 블록 생산 및 DAC 툴킷을 우선 순위로 정한 최초의 승인된 작업자 제안을 공지했씁니다. 더 읽기: <a href="https://steemit.com/eosdac/@eosdac/eosdac-announces-first-approved-worker-proposals-prioritising-block-production-and-dac-toolkit">https://steemit.com/eosdac/@eosdac/eosdac-announces-first-approved-worker-proposals-prioritising-block-production-and-dac-toolkit</a></p>

<p>현재 eosDAC 팀은 멤버십 및 관리인 투표 계약을 포함한 DAC 툴킷 MVP 버전을 곧 출시할 예정입니다.
DAC 툴킷 로드맵은 여기에서 확인할 수 있습니다: <a href="https://trello.com/b/fbz4IHXP/dac-toolkit-roadmap">https://trello.com/b/fbz4IHXP/dac-toolkit-roadmap</a></p>

      </div>
    </div>
  </div><div style="background-image:url(/assets/footer-bkgr.png);background-repeat:no-repeat;background-size:100% auto;margin-top:50px;">
    <img src="/assets/spacer.gif" style="width:100%;"/>
</div></div>
</div>

      </div>
    </main><footer class="site-footer h-card" style="border:0;padding:0;">
  <div class="footer">

    <div class="container">
      <div class="row">
        <div class="col-md-3">
          <h2 id="주요-링크">주요 링크</h2>
<p><a href="/ko/why-vote/#core-principles">Code Of Conduct</a><br />
<a href="/ko/history/">eosDAC 연혁</a><br />
<a href="/styleguide">스타일가이드</a><br />
<a href="https://steemit.com/eos/@eosdac/statement-of-ownership-and-code-of-conduct">Disclosures</a><br />
<a href="/bp.json">BP 정보</a></p>

        </div>
        <div class="col-md-6">
          <h2 id="뉴스레터">뉴스레터</h2>

          <form id="newsletterForm">
    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label for="name" class="bmd-label-floating">
                    Name
                </label>
                <input type="text" class="form-control" id="name" name="name">
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label for="email" class="bmd-label-floating">
                    Email *
                </label>
                <input type="email" class="form-control" id="email" name="email"
                    required>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <select class="form-control" id="language" name="language" required>
                <option value="">Language *</option>
                <option value="English">&nbsp;&nbsp;&nbsp;&nbsp;English</option>
                <option value="Russian">&nbsp;&nbsp;&nbsp;&nbsp;Pусский</option>
                <option value="Korean">&nbsp;&nbsp;&nbsp;&nbsp;한국어</option>
                <option value="Chinese">&nbsp;&nbsp;&nbsp;&nbsp;简体中文</option>
            </select>
        </div>
        <div class="col-md-6">
            <button type="submit" id="submitButton" class="btn">
                Subscribe
            </button>
        </div>
    </div>
</form>
<script>
$('#newsletterForm').submit(function(event) {
    event.preventDefault();
    $.post('https://toolkit-api.eosdac.io/subscribe', $(this).serialize())
    .done( function(result) {
        if(result && (result.message === 'subscribed_successfully' || result.message === 'already_subscribed')) {
            alert('Thank you, your records have been updated!');
            document.getElementById('newsletterForm').reset();
        } else {
            alert('Error:\n'+JSON.stringify(result));
        }
    })
    .fail( function(xhr, textStatus, errorThrown) {
        alert('Error '+xhr.status+':\n'+xhr.responseText);
    });
});
</script>
        </div>
        <div class="col-md-3">
          <h2 id="소셜-미디어">소셜 미디어</h2>

<p><br />
<a href="https://discord.io/eosdac"><i class="icon icon-social-discord-com"></i></a>
<a href="https://github.com/eosdac"><i class="icon icon-social-github-com"></i></a>
<a href="https://steemit.com/@eosdac"><i class="icon icon-social-steemit-com"></i></a>
<a href="https://twitter.com/eosdac"><i class="icon icon-social-twitter-com"></i></a>
<a href="https://www.instagram.com/eosdac"><i class="icon icon-social-instagram-com"></i></a>
<br />
<a href="https://facebook.com/eosdac"><i class="icon icon-social-facebook-com"></i></a>
<a href="https://www.reddit.com/r/eosdac"><i class="icon icon-social-reddit-com"></i></a>
<a href="https://vk.com/eosdac"><i class="icon icon-social-vk-com"></i></a>
<a href="https://www.linkedin.com/company/eosdac/"><i class="icon icon-social-linkedin-com"></i></a>
<a href="https://www.youtube.com/eosdac"><i class="icon icon-social-youtube-com"></i></a></p>

        </div>
      </div>
    </div>

    <div class="container">
      <hr style="padding: 10px 0; border-color: #BABDBE;" /><div class="row">
        <div class="col-md-2">
          <img src="/assets/signet-white.svg" height="50" alt="site.title">
        </div>
        <div class="col-md-10">
          
          
          <a class="nav-link" href="/ko/why-vote/"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">Why Vote for eosDAC?</a>
          
          <a class="nav-link" href="/ko/why-join/"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">Why Join eosDAC?</a>
          
          <a class="nav-link" href="/ko/why-launch/"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">Why Launch a DAC?</a>
          
          <a class="nav-link" href="/ko/community/"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">Community</a>
          
          <a class="nav-link" href="/ko/token/"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">Token</a>
          
          <a class="nav-link" href="/ko/tools/"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">Tools</a>
          
          
          
          
          
          
          
          
          
          
          <a class="nav-link" href="/ko/news/index.html"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">News</a></div>
      </div></div>
  </div>
</footer>
<script src="https://vjs.zencdn.net/7.4.1/video.js"></script>
<script src="/assets/videojs-resolution-switcher.js"></script>
<script src="https://unpkg.com/popper.js@1.12.6/dist/umd/popper.js"
  integrity="sha384-fA23ZRQ3G/J53mElWqVJEGJzU0sTs+SvzG8fXVWP+kJQ1lwFAOkcUOysnlKJC33U"
  crossorigin="anonymous"></script>
<script
  src="https://unpkg.com/bootstrap-material-design@4.1.1/dist/js/bootstrap-material-design.js"
  integrity="sha384-CauSuKpEqAFajSpkdjv3z9t8E7RlpJ1UP0lKM/+NdtSarroVKu069AlsRPKkFBz9"
  crossorigin="anonymous"></script>
<script>
$(document).ready(function() {
  $('body').bootstrapMaterialDesign()
  //initialize video players on why-join page
  videojs('why-join-video-1', null, function() {
    var player = this
    window.player = player
    player.on('fullscreenchange', function() {
      if(player.isFullscreen()) {
        label='SD'
        if(screen.width>1280) label='HD'
        player.currentResolution(label)
      } else
        player.currentResolution('SD')
    })
  }).videoJsResolutionSwitcher()
  videojs('why-join-video-2', null, function() {
    var player = this
    window.player = player
    player.on('fullscreenchange', function() {
      if(player.isFullscreen()) {
        label='SD'
        if(screen.width>1280) label='HD'
        player.currentResolution(label)
      } else
        player.currentResolution('SD')
    })
  }).videoJsResolutionSwitcher()
  videojs('why-join-video-3', null, function() {
    var player = this
    window.player = player
    player.on('fullscreenchange', function() {
      if(player.isFullscreen()) {
        label='SD'
        if(screen.width>1280) label='HD'
        player.currentResolution(label)
      } else
        player.currentResolution('SD')
    })
  }).videoJsResolutionSwitcher()
})
</script>
<!-- Voting Modal -->
<div class="modal fade" id="votingModal" tabindex="-1" role="dialog" aria-labelledby="votingModalLabel" aria-hidden="true">
<div class="modal-dialog" role="document">
    <div class="modal-content">
    <form id="votingForm">
    <div class="modal-header">
        <h5 class="modal-title" id="votingModalLabel">You already selected 30 BPs</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
            Free up one spot, to cast a vote for <code class="highlighter-rouge">eosdacserver</code>
        <br/><br/>
        <div class="container-fluid">
            <div class="row">
                <div class="col-6" style="padding:0;padding-right:10px;" id="voting_col1">
                    <!-- Will be filled via Javascript -->
                </div>
                <div class="col-6" style="padding:0;"  id="voting_col2">
                    <!-- Will be filled via Javascript -->
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <div style="padding: 0 16px;">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="submit" class="btn solid dark btn-raised">Vote now</button>
        </div>
    </div>
    </form>
    </div>
</div>
</div>

<script src="/assets/eosjs/eosjs-api.js"></script>
<script src="/assets/eosjs/eosjs-jsonrpc.js"></script>
<script src="/assets/eosjs/eosjs-jssig.js"></script>
<script src="https://cdn.scattercdn.com/file/scatter-cdn/js/latest/scatterjs-core.min.js"></script>
<script src="https://cdn.scattercdn.com/file/scatter-cdn/js/latest/scatterjs-plugin-eosjs2.min.js"></script>
<script src="https://cdn.scattercdn.com/file/scatter-cdn/js/latest/scatterjs-plugin-lynx.min.js"></script>
<script type="text/javascript">
// This file needs to be included via the LIQUID template engine, in order to make the translations work!

// Here is how to calculate the vote decay
// https://github.com/eosdac/eosdactoolkit/blob/master/eosdac-material/src/components/vote-eosdac.vue#L126
// https://github.com/eosdac/eosdactoolkit/blob/master/eosdac-material/src/components/vote-eosdac.vue#L169

const host = 'public.eosinfra.io' //TODO: use eu.eosdac.io instead? -> CORS problem
const network = {
    blockchain:'eos',
    protocol:'https',
    host,
    port:443,
    chainId:'aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906'
}
const EOSDACSERVER = 'eosdacserver'

function castVote(api, account, producers, proxy = "") {
    const transaction = {
        actions: [{
            account: 'eosio',
            name: 'voteproducer',
            authorization: [{ actor: account.name, permission: account.authority, }],
            data: { producers: producers.sort(), proxy, voter: account.name }
        }]
    }
    return api.transact(transaction, { blocksBehind: 3, expireSeconds: 30 })
}

function errHandler(scatter, target, originalContent, err) {
    console.error('Voting error:', err)
    target.textContent = originalContent
    scatter.logout()
}

function succHandler(scatter, target, msg = 'Thanks for voting!') {
    target.textContent = msg
    scatter.logout() //all done, goodbye!
}

function oneClickVote(scatter, target, originalContent) {
    target.textContent = 'Scatter voting...'

    const rpc = new eosjs_jsonrpc.default('https://'+host)
    const api = new eosjs_api.default({ rpc, signatureProvider:scatter.eosHook(network, null, true) })

    scatter.login({ accounts: [network] }).then(function() {
        const account = scatter.identity.accounts.find(x => x.blockchain === 'eos')
        api.rpc.get_account(account.name).then(function(data) {
            const vote = data.voter_info
            const proxy = vote.proxy
            let producers = vote.producers
            if(proxy !== '') {
                api.rpc.get_account(proxy).then(function(data) {
                    if(data && data.voter_info && data.voter_info.is_proxy === 1) {
                        const proxy_producers = data.voter_info.producers
                        const eosdacserverVoted = proxy_producers.some(function(bpName) { return bpName === EOSDACSERVER })
                        if(eosdacserverVoted === true) {
                            // Re-cast vote for the current proxy
                            castVote(api, account, [], proxy).then(function(result) {
                                succHandler(scatter, target, 'Voted proxy: ' + proxy)
                            }).catch(function(err) {
                                errHandler(scatter, target, originalContent, err)
                            })
                        } else {
                            // Re-cast vote for the current proxy, but notify user that it does not support eosdacserver
                            castVote(api, account, [], proxy).then(function(result) {
                                succHandler(scatter, target, 'Voted proxy: ' + proxy)
                                alert(proxy + ' does not support eosDAC. Please consider another proxy!')
                            }).catch(function(err) {
                                errHandler(scatter, target, originalContent, err)
                            })
                        }
                    } else {
                        errHandler(scatter, target, originalContent, proxy+" isn't a proxy anymore")
                        alert(proxy + ' is not a proxy anymore. Please choose another proxy!')
                    }
                }).catch(function(err) {
                    errHandler(scatter, target, originalContent, err)
                })
            } else {
                // Check status of all selected producers, e.g. if they are still registered
                Promise.all(producers.map(p => api.rpc.get_producers(true, p, 1))).then(function(responses) {
                    const reg_producers = responses.map(r => r.rows[0].owner)
                    let new_producers = []
                    // Add all selected AND registered producers into the new_producers array
                    producers.forEach(p => {
                        if(reg_producers.some(rp => rp === p)) new_producers.push(p)
                    })
                    producers = new_producers
                    const eosdacserverVoted = producers.some(function(bpName) { return bpName === EOSDACSERVER })
                    if(eosdacserverVoted === true) {
                        // Re-cast vote for current set of producers (including eosdacserver)
                        castVote(api, account, producers).then(function(result) {
                            succHandler(scatter, target)
                        }).catch(function(err) {
                            errHandler(scatter, target, originalContent, err)
                        })
                    } else {
                        if(producers.length < 30) {
                            // Add 'eosdacserver' to producers list and cast a vote
                            producers.push(EOSDACSERVER)
                            castVote(api, account, producers).then(function(result) {
                                succHandler(scatter, target)
                            }).catch(function(err) {
                                errHandler(scatter, target, originalContent, err)
                            })
                        } else {
                            // Show a modal dialog, to let the user remove one existing producer
                            // Set values inside the modal dialog
                            $('#voting_col1').empty()
                            $('#voting_col2').empty()
                            producers.sort().forEach(function(bpName, idx) {
                                const itm = '<div class="custom-control custom-checkbox"><input type="checkbox" class="custom-control-input" name="bp'+idx+'" id="bp'+idx+'" value="'+bpName+'" checked><label class="custom-control-label" style="font-family:monospace;" for="bp'+idx+'">'+bpName+'</label></div>'
                                if(idx < 15) {
                                    $(itm).appendTo('#voting_col1')
                                } else {
                                    $(itm).appendTo('#voting_col2')
                                }
                            })
                            // Register the submit callback, using local variables
                            $('#votingForm').submit(function(ev) {
                                ev.preventDefault()
                                const producers = $("#votingForm").serializeArray().map(function(elem) {
                                    return elem.value
                                })
                                // Add 'eosdacserver' to producers, if user removed one other producer
                                if(producers.length < 30) {
                                    producers.push(EOSDACSERVER)
                                }
                                castVote(api, account, producers).then(function(result) {
                                    $('#votingModal').modal('hide')
                                    succHandler(scatter, target)
                                }).catch(function(err) {
                                    $('#votingModal').modal('hide')
                                    errHandler(scatter, target, originalContent, err)
                                })
                            })
                            // Register the modal's Cancel/Hide handler, using local variables
                            $('#votingModal').on('hide.bs.modal', function (e) {
                                errHandler(scatter, target, originalContent, 'Modal cancelled/hidden.')
                            })
                            // Show the voting modal
                            $('#votingModal').modal('show')
                        }
                    }
                }).catch(function(err) {
                    errHandler(scatter, target, originalContent, err)
                })
            }
        }).catch(function(err) {
            errHandler(scatter, target, originalContent, err)
        })
    }).catch(function(err) {
        errHandler({ logout: function() { /* Scatter not signed in */ }}, target, originalContent, err)
    })
}

$(document).ready(function() {
    ScatterJS.plugins( new ScatterEOS(), new ScatterLynx() )
    ScatterJS.scatter.connect('eosDAC.io').then(function( connected ) {
        if(!connected) {
            console.error('Scatter could not be found.')
            return false
        }

        // Scatter was successfully connected
        const scatter = ScatterJS.scatter;
        window.ScatterJS = null;
        console.info('Scatter connected.')

        // Setup the click handler for '.scatter-vote-oneclick' links
        // and prevent their default (fallback) link/button behaviour,
        // i.e. do not follow their 'href'
        $('.scatter-vote-oneclick').click(function(ev) {
            ev.preventDefault()
            const target = ev.target
            const originalContent = target.textContent
            oneClickVote(scatter, target, originalContent)
        })
        console.info('Scatter handler registered.')
    })
})
</script>
</body>

</html>
