<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    
      eosDAC | 
    
  </title>
  <meta property="og:title" content="eosDAC">
  <meta property="og:site_name" content="eosDAC">
  <meta name="description" content="The Community-Owned EOS Block Producer and DAC Enabler">
  <meta property="og:description" content="The Community-Owned EOS Block Producer and DAC Enabler">
  <link rel="shortcut icon" type="image/png" href="/assets/favicon.png?1556646154">
  <link href="/assets/styles.css?1556646154s" rel="stylesheet">
  <link href="https://vjs.zencdn.net/7.4.1/video-js.css" rel="stylesheet">
  <link rel="stylesheet" href="/assets/videojs-resolution-switcher.css">
  <link rel="stylesheet"
    href="https://unpkg.com/bootstrap-material-design@4.1.1/dist/css/bootstrap-material-design.min.css"
    integrity="sha384-wXznGJNEXNG1NFsbm0ugrLFMQPWswR3lds2VeinahP8N0zJw9VWSopbjv2x7WCvX"
    crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/bootstrap-material-design-overwrite.css?1556646154">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:100,200,300,400,500,600">
  <link rel="stylesheet" href="/assets/main.css?1556646154">
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="crossorigin="anonymous"></script><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="site.title" /><link rel="alternate" hreflang="en" href="https://eosdac.io">
  <link rel="alternate" hreflang="ko" href="https://eosdac.io/ko/">
  <link rel="alternate" hreflang="zh-hans" href="https://eosdac.io/zh-hans/">
  <link rel="alternate" hreflang="vi" href="https://eosdac.io/vi/">
  <link rel="alternate" hreflang="ja" href="https://eosdac.io/ja/">
  <link rel="alternate" hreflang="es" href="https://eosdac.io/es/">
  <link rel="alternate" hreflang="ru" href="https://eosdac.io/ru/">
  <link rel="canonical" href="https://eosdac.io/">
  <script src="/assets/vconsole.min.js"></script>
  <script>
    // Init vConsole, if the ?debug=true parameter exists
    if(window.location.search.substr(1).indexOf('debug=true') >= 0) {
      var vConsole = new VConsole()
    }
  </script>
</head>
<body><header class="site-header" role="banner" style="border:0">
  <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark nav-tabs"
    style="background-image:linear-gradient(to right, #4A1289, #7C41BA)">
    <a class="navbar-brand" href="/">
      <img src="/assets/signet-white.svg" height="42" alt="eosDAC">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse"
      data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
      aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav mr-auto">
        
        
        
        
        
        
        <li class="nav-item"><a class="nav-link" href="/why-vote/">
            Why Vote for eosDAC?</a></li>
        
        
        
        
        
        <li class="nav-item"><a class="nav-link" href="/why-join/">
            Why Join eosDAC?</a></li>
        
        
        
        
        
        <li class="nav-item"><a class="nav-link" href="/why-launch/">
            Why Launch a DAC?</a></li>
        
        
        
        <li class="nav-item"><a class="nav-link" href="/community/">
            Community</a></li>
        
        
        
        
        
        <li class="nav-item"><a class="nav-link" href="/token/">
            Token</a></li>
        
        
        
        <li class="nav-item"><a class="nav-link" href="/tools/">
            Tools</a></li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <li class="nav-item"><a class="nav-link" href="/news/index.html">
            News</a></li>
        
        
        
        
        
        
        
        
        
        
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown"
            role="button" data-toggle="dropdown" aria-haspopup="true"
            aria-expanded="false">
            <img src="/assets/flags/en.png" />
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            
             
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
          </div>
        </li>
      </ul>
      <span class="navbar-text nav-buttons">
        <a href="/why-vote/#voting-matters" class="btn solid light btn-raised scatter-vote-oneclick">
          Vote eosdacserver
        </a>
        <a href="/member-client/" class="btn outline light btn-raised">
          Member Client
        </a>
      </span>
    </div>
  </nav>
</header>
<main class="page-content main" style="padding:0;" aria-label="Content">
      <div class="">
        <div>
<div class="container">
<div class="row" style="margin-top: 20px;">
<div class="col-md-12">
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Tutorial: Launching Your Own DAC on the Jungle Test Network with eosDAC</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-02-01T12:01:42-04:00" itemprop="datePublished">Feb 1, 2019
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><strong>Update:</strong> You can now use the <a href="https://steemit.com/dac/@eosdac/the-dac-factory">DAC Factory script</a> to automate much of what is described here.</p>

<center><img src="https://cdn.steemitimages.com/DQmQ2gzprShnJdwdYn7chyQmcPmmdhgYw3DXcuTXp5s4FtY/do_you_want_to_build_a_dac.jpg" /></center>

<p><strong>The future is decentralized.</strong> Lasting value will be created and maintained by communities and their network effect. Centralized hierarchies controlled by the unelected will increasingly be seen as an old, rigid model compared to dyanmic entities where everyone with skin in the game has a voice and those who create value are rewarded according to the consensus of the community expressed through elected custodians.</p>

<p>This is what eosDAC is working to build.</p>

<p>I’m regularly encouraged by friends in the cryptocurrency space excited about what eosDAC is doing who want to launch their own DACs using our open source technology. Our two reasons for existing are to be a community-owned EOS block producer and a DAC Enabler. The future vision for DAC Enabling includes a DAC Factory where anyone can launch their own DAC as easily as possible. We’re not there yet as it will take plenty of work to streamline the automation of customizations, account creation, set contract actions, and permissions configuration, but we will get there eventually.</p>

<p>Our first goal is to finish up the <a href="https://members.eosdac.io/">eosDAC Member Client</a> to have all the functionality required to run a DAC with an easy-to-use, decentralized interface.  When we turned on Custodian voting a couple months ago, I wrote a post outlining some of the main EOS accounts that make the DAC run along with the Github repos involved: <a href="https://steemit.com/eosdac/@eosdac/eosdac-custodian-candidate-voting-is-live">eosDAC Custodian Candidate Voting Is Live!</a>. I was thinking about this again recently with a post describing how Steem could organize itself as a DAC: <a href="https://steemit.com/steemdac/@lukestokes/steemdac-a-plan-we-can-start-today-to-decentralize-steem-governance">SteemDAC: A Plan We Can Start Today to Decentralize Steem Governance</a>.</p>

<p>Most of the pieces are already in place for anyone to take what we already have today and launch their own DAC. Although this will be much easier in the future with the DAC Factory, I figured it would be useful to outline all the pieces involved for the many who are so excited about this they can’t seem to wait before experimenting with their own DAC.</p>

<p><strong>Update:</strong> I went ahead and recorded a full video walk through of this tutorial as well which you can see here:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/AvM0sA07IME" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<h1 id="lets-get-started">Let’s Get Started!</h1>

<p>The following is a tutorial for how you can launch your own DAC right now using what we’ve built so far. One of the most powerful and useful aspects of a DAC is that authority is distributed among elected custodians. This protects funds and code through a multisignature permissions system updated every newperiod to include the top token-holder-elected custodians. This account for eosDAC is dacauthority which you can see here: https://bloks.io/account/dacauthority</p>

<center>
<img src="https://cdn.steemitimages.com/DQmRN7obgDRsj1rqhL3xgcyYDEGNc33vc3mxU8GdEaPXm6f/image.png" />
</center>

<p>This tutorial will walk you through everything, from start to finish, to create your own DAC authority account, along with all the other accounts and contracts which make the DAC function.</p>

<p>This tutorial was done on a Mac, but any computer with unix-based emulation will work as well.</p>

<p>To start, create a project folder (to make things easier, you can copy these commands together and run them all at once):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir TestDAC
cd TestDAC
</code></pre></div></div>

<p>Get the version of EOS you want to work with, build, and install it (this will take some time).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/EOS-Mainnet/eos.git
cd eos
git checkout mainnet-1.5.1
git submodule update --init --recursive
./eosio_build.sh -s EOS
sudo ./eosio_install.sh 
</code></pre></div></div>

<p>If you don’t have the necessary tools or libraries on your computer needed to build these libraries, check the readme file on the EOS Github.</p>

<p>You’ll also need eosio.cdt to compile your contracts:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd ..
git clone https://github.com/EOSIO/eosio.cdt.git
cd eosio.cdt
git checkout v1.4.1
git submodule update --init --recursive
./build.sh
sudo ./install.sh
</code></pre></div></div>

<p>Let’s set up a couple scripts to keep everything contained in this folder. Adjust this according to your own starting folder. Create keosd.sh as follows in the TestDAC folder:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="nv">cwd</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>
<span class="nv">$cwd</span>/eos/build/bin/keosd <span class="nt">--wallet-dir</span> <span class="nv">$cwd</span> <span class="nt">--http-server-address</span> localhost:8900 <span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span>
</code></pre></div></div>

<p>Set that to executable and run it:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chmod +x keosd.sh 
./keosd.sh
</code></pre></div></div>

<p>In a new terminal window, create a script for running cleos to connect with the Jungle test network. Create jungle.sh as follows:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="nv">cwd</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>
<span class="nv">$cwd</span>/eos/build/bin/cleos <span class="nt">--url</span> http://jungle2.cryptolions.io:80/ <span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span>
</code></pre></div></div>

<p>And use it to create a wallet:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chmod +x jungle.sh 
./jungle.sh wallet create --to-console;
Creating wallet: default
Save password to use in the future to unlock this wallet.
Without password imported keys will not be retrievable.
"PW5................................................"
</code></pre></div></div>

<p>Save this wallet password in a password manager or some other secure location.</p>

<p>Create and save an EOS keypair which we’ll use for creating our accounts on the Jungle test network.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./jungle.sh create key --to-console
Private key: 5K..................................................
Public key: EOS6vuK27d4R1vqQmNQc1b7PjGLZ3cNABtD9HEDtPuyXdZKFkwirc
</code></pre></div></div>

<p>Next head over to the Jungle testnet monitor and create the various accounts we need to run the DAC. We’ll start with the authority account: https://monitor.jungletestnet.io/#account I’ll show the example names I used, but since those are already taken on Jungle, you’ll want to use your own. Throughout this tutorial, just replace the account listed here with the account you’ve created.</p>

<center>
<img src="https://cdn.steemitimages.com/DQmZevHjYJXJUeQTa3LPpqKjkTDojtyFy61v4emSMXfVaZ2/image.png" />
</center>

<p><code class="highlighter-rouge">lukedacauth1</code></p>

<p>We also need a token account which holds all the token and membership code:</p>

<p><code class="highlighter-rouge">lukedactoken</code></p>

<p>The custodian account which handles custodian voting and more:</p>

<p><code class="highlighter-rouge">lukedaccusto</code></p>

<p>The main DAC account for holding DAC funds:</p>

<p><code class="highlighter-rouge">lukedachold1</code></p>

<p>And the multisig account where worker proposal payments will be managed:</p>

<p><code class="highlighter-rouge">lukedacmulti</code></p>

<p>You’ll want to create your own variations of these account names, just remember they have to be 12 characters long and can’t include any symbols, but only letters and numbers 1 though 5.</p>

<p>Hit up the Jungle testnet faucet for each account to ensure you have enough EOS needed for RAM, CPU, and Bandwidth:</p>

<p>https://api.monitor.jungletestnet.io/#faucet</p>

<p>Throughout this tutorial, replace your account names as needed.</p>

<p>Now unlock your wallet, import your private key, buy yourself some RAM, and stake some CPU/Bandwidth for each account (make sure keosd.sh is still running):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./jungle.sh wallet unlock
./jungle.sh wallet import
./jungle.sh system buyram lukedactoken lukedactoken "30.000 EOS"
./jungle.sh system delegatebw lukedactoken lukedactoken "10.000 EOS" "50.000 EOS"
./jungle.sh system buyram lukedacmulti lukedacmulti "30.000 EOS"
./jungle.sh system delegatebw lukedacmulti lukedacmulti "10.000 EOS" "50.000 EOS"
./jungle.sh system buyram lukedachold1 lukedachold1 "30.000 EOS"
./jungle.sh system delegatebw lukedachold1 lukedachold1 "10.000 EOS" "50.000 EOS"
./jungle.sh system buyram lukedaccusto lukedaccusto "30.000 EOS"
./jungle.sh system delegatebw lukedaccusto lukedaccusto "10.000 EOS" "50.000 EOS"
./jungle.sh system buyram lukedacauth1 lukedacauth1 "30.000 EOS"
./jungle.sh system delegatebw lukedacauth1 lukedacauth1 "10.000 EOS" "50.000 EOS"
</code></pre></div></div>

<p>If this were on the real mainnet, you’d want to adjust those numbers based on your actual needs.</p>

<p>Next we’ll get into compiling and setting the code contracts for these accounts:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir daccontracts
cd daccontracts
git clone https://github.com/eosdac/eosdactoken.git
git clone https://github.com/eosdac/daccustodian.git
git clone https://github.com/eosdac/dacmultisigs.git
</code></pre></div></div>

<p>You shouldn’t have to modify anything on the token contract, so you can set that as is (adjust paths and account names as needed):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./jungle.sh set contract lukedactoken /Users/lukestokes/Documents/workspace/eosDAC/TestDAC/daccontracts/eosdactoken/output/jungle/eosdactokens -p lukedactoken
</code></pre></div></div>

<p>There are currently some tweaks we have to make for the daccustodian account, but in the future this may not be necessary.</p>

<p>Modifiy daccustodian/daccustodian.hpp:</p>

<p>Replace <code class="highlighter-rouge">name authaccount = "dacauthority"_n;</code> with <code class="highlighter-rouge">name authaccount = "lukedacauth1"_n;</code></p>

<p>(but use the account name you created, as you should throughout this tutorial)</p>

<p>Modify the jungle compile script:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gh">diff --git a/output/jungle/compile.sh b/output/jungle/compile.sh
index 8b180ff..8889d3b 100755
</span><span class="gd">--- a/output/jungle/compile.sh
</span><span class="gi">+++ b/output/jungle/compile.sh
</span><span class="gu">@@ -1,5 +1,5 @@
</span> #!/usr/bin/env bash
 
<span class="gd">-eosio-cpp -DTOKENCONTRACT='"kasdactokens"' -DTRANSFER_DELAY=20 -o output/jungle/daccustodian/daccustodian.wasm daccustodian.cpp
</span><span class="gi">+eosio-cpp -DTOKENCONTRACT='"lukedactoken"' -DTRANSFER_DELAY=20 -o output/jungle/daccustodian/daccustodian.wasm daccustodian.cpp
</span> 
 eosio-abigen daccustodian.hpp -contract daccustodian -output output/jungle/daccustodian/daccustodian.abi
</code></pre></div></div>

<p>and run it from the TestDAC/daccontracts/daccustodian directory:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./output/jungle/compile.sh
</code></pre></div></div>

<p>Next set it from the TestDAC directory:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./jungle.sh set contract lukedaccusto /Users/lukestokes/Documents/workspace/eosDAC/TestDAC/daccontracts/daccustodian/output/jungle/daccustodian -p lukedaccusto
</code></pre></div></div>

<p>Next we’ll compile the dacmultisigs contract from TestDAC/daccontracts/dacmultisigs:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./output/jungle/compile.sh 
</code></pre></div></div>

<p>Set the contract from the TestDAC directory:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./jungle.sh set contract lukedacmulti /Users/lukestokes/Documents/workspace/eosDAC/TestDAC/daccontracts/dacmultisigs/output/jungle/dacmultisigs -p lukedacmulti
</code></pre></div></div>

<h2 id="configuration">Configuration</h2>

<p>Now let’s start configuring things.</p>

<p>The DAC is bound by the Constitution the members agree to. You can host your Constitution anywhere, but the current design hosts it on Github and uses a hash of the document to verify integrity. You should get your own legal advice as to what your Constitution should include, but for demonstration purposes only, I’m going to fork and clone the existing eosDAC Constitution and modify it slightly.</p>

<p>After forking on Github,</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:lukestokes/constitution.git
cd constitution
sed -i -- 's/eosDAC/TestDAC/g' constitution.md
git diff
git add .
git commit -m "Using TestDAC as an example"
git push
</code></pre></div></div>

<p>Get the md5 hash of your constitution via:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>md5 constitution.md
</code></pre></div></div>
<p>Use that and the raw file (with the specific commit you just made) to create a terms.json file in the TestDAC directory (it’s important to get the RAW link to the file):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo '["https://raw.githubusercontent.com/lukestokes/constitution/50de655bf59656d317222dedeb3c417358a0ecd9/constitution.md", "a2022da6e770e0b2c3e5d3a10a560dc9"]' &gt; terms.json
</code></pre></div></div>

<p>And set the terms on the account:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./jungle.sh push action lukedactoken newmemterms terms.json -p lukedactoken
</code></pre></div></div>

<p>If your wallet locks, you can unlock it with <code class="highlighter-rouge">./jungle.sh wallet unlock</code></p>

<p>You can validate that the terms were updated by using a block explorer: https://jungle.bloks.io/account/lukedactoken</p>

<p>Click Contract, Contract Tables, and then memberterms</p>

<p>Now update the token configuration:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo "[lukedaccusto]" &gt; token_config.json
./jungle.sh push action lukedactoken updateconfig token_config.json -p lukedactoken
</code></pre></div></div>

<p>Create and issue your own DAC tokens. In this example I’m using TESTDAC. Note, you can only do this once, so don’t mess it up. :)</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./jungle.sh push action lukedactoken create '["lukedactoken", "10000000000.0000 TESTDAC", 0]' -p lukedactoken
./jungle.sh push action lukedactoken issue '["lukedactoken", "1000000000.0000 TESTDAC", "Issue"]' -p lukedactoken
</code></pre></div></div>

<p>Get your config file for the DAC:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo '[["35000.0000 TESTDAC", 5, 12, 60, "lukedacauth1", "lukedachold1", "", 1, 15, 3, 10, 9, 7, 7776000, "50.0000 EOS"]]' &gt; dac_config.json
</code></pre></div></div>

<p>The values in that dac_config.json map to the following settings:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(lockupasset)
(maxvotes)
(numelected)
(periodlength)
(authaccount)
(tokenholder)
(serviceprovider)
(should_pay_via_service_provider)
(initial_vote_quorum_percent)
(vote_quorum_percent)
(auth_threshold_high)
(auth_threshold_mid)
(auth_threshold_low)
(lockup_release_time_delay)
(requested_pay_max)
</code></pre></div></div>

<p>To fully understand how these parameters are used, you may need to read the Constitution and the code. For now, we’ll stick with similar values as what eosDAC is using. This can be updated at a later as needed.</p>

<p>Let’s set our config:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./jungle.sh push action lukedaccusto updateconfig dac_config.json -p lukedacauth1
</code></pre></div></div>
<p>Note: the permissions on this call are a little unique in that the contract as currently designed requires the lukedacauth1 account which is why we had to make modifications earlier. This will be improved in a future release so the initial set up can be authorized by _self.</p>

<h2 id="set-up-the-front-end-client">Set Up the Front End Client</h2>

<p>Okay! Now we’re ready to hook up the front end tools to our DAC contract accounts. Fork the https://github.com/eosdac/eosdactoolkit repo and make all your own customizations:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:lukestokes/eosdactoolkit.git
cd eosdactoolkit/eosdac-material/src
git checkout dev
grep -lr --exclude-dir=".git" -e "eosDAC" . | xargs sed -i '' -e 's/eosDAC/TestDAC/g'
git commit -a -m "Replacing eosDAC with TestDAC"
git push
</code></pre></div></div>

<p>Follow the readme here to get going: https://github.com/eosdac/eosdactoolkit/tree/master/eosdac-material</p>

<p>Make changes to the jungle config file like so:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gh">diff --git a/eosdac-material/src/statics/config.jungle.json b/eosdac-material/src/statics/config.jungle.json
index 5b4bd96..fc0f04b 100644
</span><span class="gd">--- a/eosdac-material/src/statics/config.jungle.json
</span><span class="gi">+++ b/eosdac-material/src/statics/config.jungle.json
</span><span class="gu">@@ -3,16 +3,16 @@
</span>     "chainId": "e70aaab8997e1dfce58fbfac80cbbb8fecec7b99cf982a9444273cbc64c41473",
     "name": "jungle2",
     "default_node": "http://jungle2.cryptolions.io:80",
<span class="gd">-    "authorityAccount": "dacauthority",
</span><span class="gi">+    "authorityAccount": "lukedacauth1",
</span> 
     "tokenContracts":{
       "eosio.token":[{"token": "EOS", "decimals": 4 }],
<span class="gd">-      "kasdactokens":[{"token": "KASDAC", "decimals": 4}]
</span><span class="gi">+      "lukedactoken":[{"token": "TESTDAC", "decimals": 4}]
</span>     },
 
     "tokenContract": {
<span class="gd">-      "name": "kasdactokens",
-      "token": "KASDAC",
</span><span class="gi">+      "name": "lukedactoken",
+      "token": "TESTDAC",
</span>       "decimals": 4,
       "totalSupply": 1000000000.0000
     },
<span class="gu">@@ -22,12 +22,12 @@
</span>       "decimals": 4
     },
     "custodianContract": {
<span class="gd">-      "name": "dacelections",
-      "memo": "dacelections",
</span><span class="gi">+      "name": "lukedaccusto",
+      "memo": "lukedaccusto",
</span>       "enable_voting" : true
     },
     "msigContract":{
<span class="gd">-      "name": "dacmultisigs"
</span><span class="gi">+      "name": "lukedacmulti"
</span>     },
     "systemContract": {
       "name": "eosio"
<span class="gu">@@ -35,7 +35,7 @@
</span>   },
   "api": {
     "bpNodeApiUrl": "https://eosdac.io/topnodes.json",
<span class="gd">-    "memberClientApiUrl": "http://ns3119712.ip-51-38-42.eu:3000"
</span><span class="gi">+    "memberClientApiUrl": "http://localhost:3000"
</span>   },
</code></pre></div></div>

<p>Save and commit those changes:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git diff
git commit -a -m "Updating jungle config for our own needs."
git push
</code></pre></div></div>

<p>From the eosdac-material folder, install what you need and run the dev server (note: using the deploy script will remove any local changes you have that have not been committed to git):</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd eosdac-material
yarn install
cd ..
./deploy-eosdac-material.sh jungle dev true
</code></pre></div></div>

<p>If you have Scatter configured already for the Jungle test net, then you can add the lukedactoken@active account there to transfer tokens around as needed for more testing.</p>

<p>Congratulations! You’ve made great progress so far. Get yourself a beer or your drink of choice!</p>

<h2 id="setting-up-our-chain-watchers-and-api">Setting Up our Chain Watchers and API</h2>

<p>Now let’s get that Profile Watcher working. First start up a local copy of mongod in its own window:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mongod
</code></pre></div></div>
<p>Then move on to the scraper. This tool watches the Jungle chain for member profiles and saves them to mongodb so they can easily be accessed by the member client later.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:lukestokes/Actionscraper-rpc.git
cd Actionscraper-rpc
git checkout dev
</code></pre></div></div>
<p>Edit watchers/config.jungle.js as needed:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gh">diff --git a/watchers/config.jungle.js b/watchers/config.jungle.js
index afc7af6..647ef86 100644
</span><span class="gd">--- a/watchers/config.jungle.js
</span><span class="gi">+++ b/watchers/config.jungle.js
</span><span class="gu">@@ -7,17 +7,17 @@ const config = {
</span> 
     db: {
         mongoUrl: 'mongodb://localhost:27017/',
<span class="gd">-        dbName: 'eosdac'
</span><span class="gi">+        dbName: 'testdac'
</span>     },
 
     contracts:{
<span class="gd">-        custodian: 'dacelections',
-        token: 'kasdactokens',
-        msig: 'dacmultisigs'
</span><span class="gi">+        custodian: 'lukedaccusto',
+        token: 'lukedactoken',
+        msig: 'lukedacmulti'
</span>     }
 
 }
</code></pre></div></div>
<p>Get your config set up and start the watcher:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn install
cp watchers/config.jungle.js watchers/config.js
node watcher_custodian.js
</code></pre></div></div>
<p>On a production server, you’d want to use the start.sh script and pm2, but just running it via node is fine for our testing.</p>

<p>Now that we have our watcher going to look for profile changes, we need to get an API going for the member client to talk to by forking https://github.com/eosdac/memberclient-api:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:lukestokes/memberclient-api.git
cd memberclient-api
</code></pre></div></div>

<p>Make changes to the config file as needed and copy it to config.json</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gh">diff --git a/config.example.json b/config.example.json
index ab85c52..86ae7f8 100644
</span><span class="gd">--- a/config.example.json
</span><span class="gi">+++ b/config.example.json
</span><span class="gu">@@ -14,7 +14,7 @@
</span>   },
 
   "db": {
<span class="gd">-    "name": "eosdac",
</span><span class="gi">+    "name": "testdac",
</span>     "url": "mongodb://localhost:27017/eosdac"
   },
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cp config.example.json config.json
node api_endpoint.js 
</code></pre></div></div>

<p>Next up we’re going to modify the permissions on all these accounts so that everything will be controlled by lukedacauth1 which will get updated permissions every time a newperiod is called.</p>

<p>Using the tesnet permissions script here as a pattern: https://github.com/eosdac/DACtools/blob/master/eosdac-testnet/permissions.sh we can set everything up as we need.</p>

<p>First, let’s get some permissions files set up:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo '{
    "threshold" : 1,
    "keys" : [],
    "accounts": [{"permission":{"actor":"lukedacauth1", "permission":"active"}, "weight":1}],
    "waits": []
}' &gt; resign.json

echo '{
    "threshold": 2,
    "keys": [],
    "accounts": [
        {"permission":{"actor":"lukedacauth1", "permission":"med"}, "weight":2},
        {"permission":{"actor":"lukedaccusto", "permission":"eosio.code"}, "weight":1}
    ],
    "waits": [{"wait_sec":3600, "weight":1}]
}' &gt; daccustodian_transfer.json

echo '{
    "threshold": 1,
    "keys": [{"key":"EOS6vuK27d4R1vqQmNQc1b7PjGLZ3cNABtD9HEDtPuyXdZKFkwirc", "weight":1}],
    "accounts": [
        {"permission":{"actor":"lukedaccusto", "permission":"eosio.code"}, "weight":1}
    ],
    "waits": []
}' &gt; dacauthority_owner.json

echo '{
    "threshold": 1,
    "keys": [{"key":"EOS6vuK27d4R1vqQmNQc1b7PjGLZ3cNABtD9HEDtPuyXdZKFkwirc", "weight":1}],
    "accounts": [
        {"permission":{"actor":"lukedacauth1", "permission":"high"}, "weight":1}
    ],
    "waits": []
}' &gt; dacauthority_active.json

</code></pre></div></div>
<p>Now we can update things:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># These have to be set now because they are required in daccustodian_transfer.json
# These permissions are set in new period to the custodians with each configured threshold
./jungle.sh set account permission lukedacauth1 high EOS6vuK27d4R1vqQmNQc1b7PjGLZ3cNABtD9HEDtPuyXdZKFkwirc owner -p lukedacauth1@owner
./jungle.sh set account permission lukedacauth1 med EOS6vuK27d4R1vqQmNQc1b7PjGLZ3cNABtD9HEDtPuyXdZKFkwirc high -p lukedacauth1@owner
./jungle.sh set account permission lukedacauth1 low EOS6vuK27d4R1vqQmNQc1b7PjGLZ3cNABtD9HEDtPuyXdZKFkwirc med -p lukedacauth1@owner
./jungle.sh set account permission lukedacauth1 one EOS6vuK27d4R1vqQmNQc1b7PjGLZ3cNABtD9HEDtPuyXdZKFkwirc low -p lukedacauth1@owner

# resign dactokens account to dacauthority@active
./jungle.sh set account permission lukedactoken active ./resign.json owner -p lukedactoken@owner
./jungle.sh set account permission lukedactoken owner ./resign.json '' -p lukedactoken@owner

# resign dacmultisigs account to dacauthority@active
./jungle.sh set account permission lukedacmulti active ./resign.json owner -p lukedacmulti@owner
./jungle.sh set account permission lukedacmulti owner ./resign.json '' -p lukedacmulti@owner

# resign dacowner account to dacauthority@active, must allow timelocked transfers
# from daccustodian@eosio.code
# daccustodian_transfer.json allows the contract to make transfers with a time delay, or
# dacauthority@med without a time delay.  dacowner must have permission in xfer to transfer tokens
./jungle.sh set account permission lukedachold1 xfer ./daccustodian_transfer.json active -p lukedachold1@owner
./jungle.sh set action permission lukedachold1 eosio.token transfer xfer -p lukedachold1@owner
# Resign eosdacthedac
./jungle.sh set account permission lukedachold1 active ./resign.json owner -p lukedachold1@owner
./jungle.sh set account permission lukedachold1 owner ./resign.json '' -p lukedachold1@owner

# Create xfer permission and give it permission to transfer TESTDAC tokens
./jungle.sh set account permission lukedaccusto xfer ./daccustodian_transfer.json active -p lukedaccusto@owner
./jungle.sh set action permission lukedaccusto lukedactoken transfer xfer -p lukedaccusto@owner
# Resign daccustodian
./jungle.sh set account permission lukedaccusto active ./resign.json owner -p lukedaccusto@owner
./jungle.sh set account permission lukedaccusto owner ./resign.json '' -p lukedaccusto@owner

# Allow high to call any action on daccustodian
./jungle.sh set action permission lukedacauth1 lukedaccusto '' high -p lukedacauth1@owner
# These 2 actions require a medium permission
./jungle.sh set action permission lukedacauth1 lukedaccusto firecust med -p lukedacauth1@owner
./jungle.sh set action permission lukedacauth1 lukedaccusto firecand med -p lukedacauth1@owner
# Allow one to call the multisig actions
./jungle.sh set action permission lukedacauth1 lukedacmulti '' one -p lukedacauth1@owner
# set dacauthority@owner to point to daccustodian@eosio.code
./jungle.sh set account permission lukedacauth1 active ./dacauthority_active.json owner -p lukedacauth1@owner
# Only run this once you are done making any code changes:
#./jungle.sh set account permission lukedacauth1 owner ./dacauthority_owner.json '' -p lukedacauth1@owner
</code></pre></div></div>

<p>In the example above, we keep the key on owner and active in case something breaks in the code and you can’t quickly get a multisignature request together to fix it, but in production you’d want to remove the keys from dacauthority_active.json and dacauthority_owner.json and run that last commented out command.</p>

<p>Now you can go in and use your Jungle test net accounts to register as custodian candidates and vote. They will need TESTDAC tokens so you can transfer them around like so:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./jungle.sh transfer -c lukedactoken lukedactoken testdaccust1 "50000.0000 TESTDAC" "" -p lukedactoken
</code></pre></div></div>

<p>In order to launch the DAC and call newperiod, you’ll need a full 12 custodians, so you can create a bunch on Jungle like so:</p>

<p>testdaccust1
testdaccust2
testdaccust3
testdaccust4
testdaccust5
testdaccus11
testdaccus12
testdaccus13
testdaccus14
testdaccus15</p>

<p>Just use</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./jungle.sh create key --to-console
</code></pre></div></div>
<p>To create a key for them to use. You can either use the Scatter interface and your member client or you can do things via cleos.</p>

<p>To register as a member, stake TESTDAC tokens, nominate yourself as a custodian candidate, and vote for yourself via cleos you use the Constitution hash we saved above (make sure you import the key you need with <code class="highlighter-rouge">./jungle.sh wallet import</code>) like so:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./jungle.sh push action lukedactoken memberreg '["testdaccust1", "a2022da6e770e0b2c3e5d3a10a560dc9"]' -p testdaccust1
./jungle.sh transfer -c lukedactoken testdaccust1 lukedaccusto "35000.0000 TESTDAC" "lukedaccusto" -p testdaccust1
./jungle.sh push action lukedaccusto nominatecand '["testdaccust1", "1.0000 EOS"]' -p testdaccust1
./jungle.sh push action lukedaccusto votecust '["testdaccust1",["testdaccust1"]]' -p testdaccust1
</code></pre></div></div>

<p>Assuming we have 12 custodian candidates in place, you can call newperiod to actually unlock the DAC:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./jungle.sh push action lukedaccusto newperiod '{"message":"New Period"}' -p testdaccus15
</code></pre></div></div>

<p>And that’s it! You now have your very own DAC to play with!</p>

<p>You should see the permissions of your authority account update like so:</p>

<center><img src="https://cdn.steemitimages.com/DQmVTYuWDAB4tc3WPxJrUmRMejhSUWK8X1JDFuXk8TTW3SN/image.png" /></center>

<p>For fun, let’s go ahead and customize the member client a bit by changing some colors:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gh">diff --git a/eosdac-material/src/css/themes/common.variables.styl b/eosdac-material/src/css/themes/common.variables.styl
index a04237f..0c48881 100644
</span><span class="gd">--- a/eosdac-material/src/css/themes/common.variables.styl
</span><span class="gi">+++ b/eosdac-material/src/css/themes/common.variables.styl
</span><span class="gu">@@ -15,8 +15,8 @@
</span> // to match your app's branding.
 @import "core-override.variables.styl"
 
<span class="gd">-$primary   = #4a1289
-$secondary = #26A69A
</span><span class="gi">+$primary   = #1a9c41
+$secondary = #076a61
</span> $tertiary  = #555
 
 $neutral   = #E0E1E2
<span class="gu">@@ -25,12 +25,12 @@ $negative  = #DB2828
</span> $info      = #31CCEC
 $warning   = #F2C037
 
<span class="gd">-$dark      = #272B35
</span><span class="gi">+$dark      = #2b3527
</span> $p-light   = #7c41ba
 $dark2     = #1E2128
 $dimwhite  = rgba(255,255,255,0.6)
 
<span class="gd">-$body-background = #272B35
</span><span class="gi">+$body-background = #2b3527
</span> $body-color = #ffffff
 $modal-body-color = $white
 $modal-background = $dark2
</code></pre></div></div>
<p>And adding a different logo image (be sure to copy the image to the statics/img folder):</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gh">diff --git a/eosdac-material/src/layouts/default.vue b/eosdac-material/src/layouts/default.vue
index b7e7ecf..8d51a3b 100644
</span><span class="gd">--- a/eosdac-material/src/layouts/default.vue
</span><span class="gi">+++ b/eosdac-material/src/layouts/default.vue
</span><span class="gu">@@ -7,7 +7,7 @@
</span>         &lt;q-icon v-else name="icon-menu-9" /&gt;
       &lt;/q-btn&gt;
       &lt;q-toolbar-title class="text-white q-pl-none"&gt;
<span class="gd">-        &lt; img src="statics/img/icon-signet-eosdacmemberclient175x48.svg" style="height:48px;" :title="$t('default.member_client')"&gt;
</span><span class="gi">+        &lt; img src="statics/img/do_you_want_to_build_a_dac.jpg" style="height:48px;" :title="$t('default.member_client')"&gt;
</span>       &lt;/q-toolbar-title&gt;
       &lt;div class="xs-hide sm-hide md-hide" &gt;
         &lt;MenuDropdown class="no-pointer-events animate-fade" v-if="getAccountName &amp;&amp; getRegistered &amp;&amp; getTokenBalance" iconColor="white" :label="$t('default.member_status')" :statusLabel="1" :sublabel="$t('default.registered')" icon="icon-role-3" /&gt;
</code></pre></div></div>
<p><sub>(Note: the space added after the “&lt;” above should be removed. It was included because of <a href="https://github.com/steemit/condenser/issues/3200">this bug</a>.)</sub>
Here’s the result:</p>
<center><img src="https://cdn.steemitimages.com/DQmTK3P4YjiuYJJj4MxmxHfZruNaNYCH9WADcHoHBcUkDny/image.png" /></center>

<p>And that’s it! Congratulations! You’ve created your own Decentralized Autonomous Community on the Jungle test net! Customizing the member client involves learning a bit about Material Design, the Quasar framework, and Vue.js. You can also adjust your DAC settings by having more or less than 12 custodians, changing the voting weights, and more.</p>

<p>We’d love to get your feedback on this as you start to use it to organize and empower your own communities. To support this ongoing work, please vote for the EOS blockproducer <code class="highlighter-rouge">eosdacserver</code> or use a proxy who supports us. We’d also really like to see more DACs launch and airdrop the tokens they create to our eosDAC members (currently just over 1,900 accounts) who have supoorted us and made this possible. Thank you!</p>

<p><sub><em>Luke with the incredible work and help of Michael, Dallas, Piecesnbits, Nod74, and many more.<em>&lt;/sub&gt;</em></em></sub></p>

<hr />

<p><a href="https://eosdac.io/"><img src="https://cdn.steemitimages.com/DQmRQWM3QtQ21wddAMCjbVRhB3rM7L4AGWLY9QpNmkXNLps/Screen%20Shot%202018-06-12%20at%2011.00.55%20PM.png" /></a></p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/PbQpAJOP6iA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen=""></iframe>

<center><h1>Please vote for eosdacserver</h1></center>

<p>Join <a href="https://eosdac.io/news/#newsletter">our newsletter</a> to stay informed and follow us on your favorite social media platform:</p>

<p><sub><a href="https://steemit.com/@eosdac" target="_blank">Steemit</a> | <a href="http://discord.io/eosdac" target="_blank">Discord</a> | <a href="https://t.me/eosdacio" target="_blank">Telegram</a> | <a href="https://facebook.com/eosdac" target="_blank">Facebook</a> | <a href="https://twitter.com/eosdac" target="_blank">Twitter</a> | <a href="https://plus.google.com/+eosdac" target="_blank">Google-plus</a> | <a href="https://github.com/eosdac" target="_blank">Github</a> | <a href="https://instagram.com/eosdac" target="_blank">Instagram</a> | <a href="https://linkedin.com/company/eosdac" target="_blank">Linkedin</a> | <a href="https://medium.com/eosdac" target="_blank">Medium</a> | <a href="https://www.reddit.com/r/EOSDAC/" target="_blank">Reddit</a> | <a href="https://www.youtube.com/eosdac" target="_blank">YouTube</a> | &lt;a href=”http://weibo.com/eosdac” target=”_blank”&gt;Weibo&lt;/a&gt;| <a href="https://vk.com/eosdac" target="_blank">VK</a>| <a href="https://bihu.com/people/586348" target="_blank">Bihu</a></sub></p>

  </div><a class="u-url" href="/2019/02/01/tutorial-launching-your-own-dac-on-the-jungle-test-network-with-eosdac.html" hidden></a>
</article>

  <a href="https://steemit.com/dac/@eosdac/tutorial-launching-your-own-dac-on-the-jungle-test-network-with-eosdac">Read more ↗</a><br/><br/>


<a href="/news">Back</a>
</div>
</div>
</div><div style="background-image:url(/assets/footer-bkgr.png);background-repeat:no-repeat;background-size:100% auto;margin-top:50px;">
    <img src="/assets/spacer.gif" style="width:100%;"/>
</div></div>
      </div>
    </main><footer class="site-footer h-card" style="border:0;padding:0;">
  <div class="footer">

    <div class="container">
      <div class="row">
        <div class="col-md-3">
          <h2 id="important-links">Important Links</h2>
<p><a href="/why-vote/#core-principles">Code Of Conduct</a><br />
<a href="/history/">eosDAC History</a><br />
<a href="https://eosdac.zendesk.com/">Help Center</a><br />
<a href="/styleguide">Styleguide</a><br />
<a href="https://steemit.com/eos/@eosdac/statement-of-ownership-and-code-of-conduct">Disclosures</a><br />
<a href="/bp.json">BP Info</a></p>

        </div>
        <div class="col-md-6">
          <h2 id="newsletter">Newsletter</h2>

          <form id="newsletterForm">
    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label for="name" class="bmd-label-floating">
                    Name
                </label>
                <input type="text" class="form-control" id="name" name="name">
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label for="email" class="bmd-label-floating">
                    Email *
                </label>
                <input type="email" class="form-control" id="email" name="email"
                    required>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <select class="form-control" id="language" name="language" required>
                <option value="">Language *</option>
                <option value="English">&nbsp;&nbsp;&nbsp;&nbsp;English</option>
                <option value="Russian">&nbsp;&nbsp;&nbsp;&nbsp;Pусский</option>
                <option value="Korean">&nbsp;&nbsp;&nbsp;&nbsp;한국어</option>
                <option value="Chinese">&nbsp;&nbsp;&nbsp;&nbsp;简体中文</option>
            </select>
        </div>
        <div class="col-md-6">
            <button type="submit" id="submitButton" class="btn">
                Subscribe
            </button>
        </div>
    </div>
</form>
<script>
$('#newsletterForm').submit(function(event) {
    event.preventDefault();
    $.post('https://toolkit-api.eosdac.io/subscribe', $(this).serialize())
    .done( function(result) {
        if(result && (result.message === 'subscribed_successfully' || result.message === 'already_subscribed')) {
            alert('Thank you, your records have been updated!');
            document.getElementById('newsletterForm').reset();
        } else {
            alert('Error:\n'+JSON.stringify(result));
        }
    })
    .fail( function(xhr, textStatus, errorThrown) {
        alert('Error '+xhr.status+':\n'+xhr.responseText);
    });
});
</script>
        </div>
        <div class="col-md-3">
          <h2 id="social-media">Social Media</h2>
<p><a href="https://discord.io/eosdac"><i class="icon icon-social-discord-com"></i></a>
<a href="https://github.com/eosdac"><i class="icon icon-social-github-com"></i></a>
<a href="https://steemit.com/@eosdac"><i class="icon icon-social-steemit-com"></i></a>
<a href="https://twitter.com/eosdac"><i class="icon icon-social-twitter-com"></i></a>
<a href="https://www.instagram.com/eosdac"><i class="icon icon-social-instagram-com"></i></a>
<br />
<a href="https://facebook.com/eosdac"><i class="icon icon-social-facebook-com"></i></a>
<a href="https://www.reddit.com/r/eosdac"><i class="icon icon-social-reddit-com"></i></a>
<a href="https://vk.com/eosdac"><i class="icon icon-social-vk-com"></i></a>
<a href="https://www.linkedin.com/company/eosdac/"><i class="icon icon-social-linkedin-com"></i></a>
<a href="https://www.youtube.com/eosdac"><i class="icon icon-social-youtube-com"></i></a>
<br />
<a href="https://murmurdapp.com/userpost/eosdacmurmur"><i class="icon icon-social-murmur"></i></a>
<a href="https://t.me/eosdacio"><i class="icon icon-social-telegram"></i></a></p>

        </div>
      </div>
    </div>

    <div class="container">
      <hr style="padding: 10px 0; border-color: #BABDBE;" /><div class="row">
        <div class="col-md-2">
          <img src="/assets/signet-white.svg" height="50" alt="site.title">
        </div>
        <div class="col-md-10">
          
          
          
          
          <a class="nav-link" href="/why-vote/"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">Why Vote for eosDAC?</a>
          
          
          <a class="nav-link" href="/why-join/"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">Why Join eosDAC?</a>
          
          
          <a class="nav-link" href="/why-launch/"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">Why Launch a DAC?</a>
          
          <a class="nav-link" href="/community/"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">Community</a>
          
          
          <a class="nav-link" href="/token/"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">Token</a>
          
          <a class="nav-link" href="/tools/"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">Tools</a>
          
          
          
          
          
          
          
          
          
          
          
          <a class="nav-link" href="/news/index.html"
            style="text-transform: none; display: inline-block; margin-top: 5px;
            color: white;">News</a>
          
          
          
          
          </div>
      </div></div>
  </div>
</footer>
<script src="https://vjs.zencdn.net/7.4.1/video.js"></script>
<script src="/assets/videojs-resolution-switcher.js"></script>
<script src="https://unpkg.com/popper.js@1.12.6/dist/umd/popper.js"
  integrity="sha384-fA23ZRQ3G/J53mElWqVJEGJzU0sTs+SvzG8fXVWP+kJQ1lwFAOkcUOysnlKJC33U"
  crossorigin="anonymous"></script>
<script
  src="https://unpkg.com/bootstrap-material-design@4.1.1/dist/js/bootstrap-material-design.js"
  integrity="sha384-CauSuKpEqAFajSpkdjv3z9t8E7RlpJ1UP0lKM/+NdtSarroVKu069AlsRPKkFBz9"
  crossorigin="anonymous"></script>
<script>
$(document).ready(function() {
  $('body').bootstrapMaterialDesign()
  //initialize video players on why-join page
  videojs('why-join-video-1', null, function() {
    var player = this
    window.player = player
    player.on('fullscreenchange', function() {
      if(player.isFullscreen()) {
        label='SD'
        if(screen.width>1280) label='HD'
        player.currentResolution(label)
      } else
        player.currentResolution('SD')
    })
  }).videoJsResolutionSwitcher()
  videojs('why-join-video-2', null, function() {
    var player = this
    window.player = player
    player.on('fullscreenchange', function() {
      if(player.isFullscreen()) {
        label='SD'
        if(screen.width>1280) label='HD'
        player.currentResolution(label)
      } else
        player.currentResolution('SD')
    })
  }).videoJsResolutionSwitcher()
  videojs('why-join-video-3', null, function() {
    var player = this
    window.player = player
    player.on('fullscreenchange', function() {
      if(player.isFullscreen()) {
        label='SD'
        if(screen.width>1280) label='HD'
        player.currentResolution(label)
      } else
        player.currentResolution('SD')
    })
  }).videoJsResolutionSwitcher()
})
</script>
<!-- Voting Modal -->
<div class="modal fade" id="votingModal" tabindex="-1" role="dialog" aria-labelledby="votingModalLabel" aria-hidden="true">
<div class="modal-dialog" role="document">
    <div class="modal-content">
    <form id="votingForm">
    <div class="modal-header">
        <h5 class="modal-title" id="votingModalLabel">You already selected 30 BPs</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
            Free up one spot, to cast a vote for <code class="highlighter-rouge">eosdacserver</code>
        <br/><br/>
        <div class="container-fluid">
            <div class="row">
                <div class="col-6" style="padding:0;padding-right:10px;" id="voting_col1">
                    <!-- Will be filled via Javascript -->
                </div>
                <div class="col-6" style="padding:0;"  id="voting_col2">
                    <!-- Will be filled via Javascript -->
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <div style="padding: 0 16px;">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="submit" class="btn solid dark btn-raised">Vote now</button>
        </div>
    </div>
    </form>
    </div>
</div>
</div>

<script src="/assets/eosjs/eosjs-api.js?1556646154"></script>
<script src="/assets/eosjs/eosjs-jsonrpc.js?1556646154"></script>
<script src="https://cdn.scattercdn.com/file/scatter-cdn/js/latest/scatterjs-core.min.js?1556646154"></script>
<script src="https://cdn.scattercdn.com/file/scatter-cdn/js/latest/scatterjs-plugin-eosjs2.min.js?1556646154"></script>
<script src="https://cdn.scattercdn.com/file/scatter-cdn/js/latest/scatterjs-plugin-lynx.min.js?1556646154"></script>
<script type="text/javascript">
// This file needs to be included via the LIQUID template engine, in order to make the translations work!

// Here is how to calculate the vote decay
// https://github.com/eosdac/eosdactoolkit/blob/master/eosdac-material/src/components/vote-eosdac.vue#L126
// https://github.com/eosdac/eosdactoolkit/blob/master/eosdac-material/src/components/vote-eosdac.vue#L169

const host = 'public.eosinfra.io' //TODO: use eu.eosdac.io instead? -> CORS problem
const network = {
    blockchain:'eos',
    protocol:'https',
    host,
    port:443,
    chainId:'aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906'
}
const EOSDACSERVER = 'eosdacserver'

function castVote(api, account, producers, proxy = "") {
    const transaction = {
        actions: [{
            account: 'eosio',
            name: 'voteproducer',
            authorization: [{ actor: account.name, permission: account.authority, }],
            data: { producers: producers.sort(), proxy, voter: account.name }
        }]
    }
    return api.transact(transaction, { blocksBehind: 3, expireSeconds: 30 })
}

function errHandler(scatter, target, originalContent, err, showAlert = true) {
    console.error('Voting error:', err)
    target.textContent = originalContent
    scatter.logout()

    // Do not show an alert() if the user rejected the transaction on purpose
    const rejected = ['signature_rejected', 'identity_rejected', 'Request Canceled']
    if(err &&  (rejected.includes(err.type) || rejected.includes(err.message))) {
        showAlert = false
    }
    if(showAlert) alert('Error: ' + JSON.stringify(err))
}

function succHandler(scatter, target, msg = 'Thanks for voting!') {
    target.textContent = msg
    scatter.logout() //all done, goodbye!
}

function oneClickVote(scatter, target, originalContent) {
    target.textContent = 'Voting...'

    const rpc = new eosjs_jsonrpc.JsonRpc('https://'+host)
    const api = new eosjs_api.Api({ rpc, signatureProvider:scatter.eosHook(network, null, true) })

    scatter.login({ accounts: [network] }).then(function() {
        const account = scatter.identity.accounts.find(x => x.blockchain === 'eos')
        /*
        We could also use get_table_rows() to get the voter_info,
        but need to make sure that the result is for 'account.name'.
        get_table_rows({
            json: true,
            code: 'eosio',
            scope: 'eosio',
            table: 'voters',
            lower_bound: account.name,
            limit: 1
        })
        */
        api.rpc.get_account(account.name).then(function(data) {
            const vote = data.voter_info
            let proxy = ''
            let producers = []
            // If vote (e.g. account.voter_info) is 'null', the eosio.voters table is empty for this account,
            // i.e. the account never voted before: Just vote for ['eosdacserver'] in this case!
            if(vote !== null) {
                proxy = vote.proxy
                producers = vote.producers
            }
            if(proxy !== '') {
                api.rpc.get_account(proxy).then(function(data) {
                    if(data && data.voter_info && data.voter_info.is_proxy === 1) {
                        const proxy_producers = data.voter_info.producers
                        const eosdacserverVoted = proxy_producers.some(function(bpName) { return bpName === EOSDACSERVER })
                        if(eosdacserverVoted === true) {
                            // Re-cast vote for the current proxy
                            castVote(api, account, [], proxy).then(function(result) {
                                succHandler(scatter, target, 'Voted proxy: ' + proxy)
                            }).catch(function(err) {
                                errHandler(scatter, target, originalContent, err)
                            })
                        } else {
                            // Re-cast vote for the current proxy, but notify user that it does not support eosdacserver
                            castVote(api, account, [], proxy).then(function(result) {
                                succHandler(scatter, target, 'Voted proxy: ' + proxy)
                                alert(proxy + ' does not support eosDAC. Please consider another proxy!')
                            }).catch(function(err) {
                                errHandler(scatter, target, originalContent, err)
                            })
                        }
                    } else {
                        errHandler(scatter, target, originalContent, proxy+" isn't a proxy anymore")
                        alert(proxy + ' is not a proxy anymore. Please choose another proxy!')
                    }
                }).catch(function(err) {
                    errHandler(scatter, target, originalContent, err)
                })
            } else {
                // Check status of all selected producers, e.g. if they are still registered
                Promise.all(producers.map(p => api.rpc.get_producers(true, p, 1))).then(function(responses) {
                    const reg_producers = responses.map(r => r.rows[0].owner)
                    let new_producers = []
                    // Add all selected AND registered producers into the new_producers array
                    producers.forEach(p => {
                        if(reg_producers.some(rp => rp === p)) new_producers.push(p)
                    })
                    producers = new_producers
                    const eosdacserverVoted = producers.some(function(bpName) { return bpName === EOSDACSERVER })
                    if(eosdacserverVoted === true) {
                        // Re-cast vote for current set of producers (including eosdacserver)
                        castVote(api, account, producers).then(function(result) {
                            succHandler(scatter, target)
                        }).catch(function(err) {
                            errHandler(scatter, target, originalContent, err)
                        })
                    } else {
                        if(producers.length < 30) {
                            // Add 'eosdacserver' to producers list and cast a vote
                            producers.push(EOSDACSERVER)
                            castVote(api, account, producers).then(function(result) {
                                succHandler(scatter, target)
                            }).catch(function(err) {
                                errHandler(scatter, target, originalContent, err)
                            })
                        } else {
                            // Show a modal dialog, to let the user remove one existing producer
                            // Set values inside the modal dialog
                            $('#voting_col1').empty()
                            $('#voting_col2').empty()
                            producers.sort().forEach(function(bpName, idx) {
                                const itm = '<div class="custom-control custom-checkbox"><input type="checkbox" class="custom-control-input" name="bp'+idx+'" id="bp'+idx+'" value="'+bpName+'" checked><label class="custom-control-label" style="font-family:monospace;" for="bp'+idx+'">'+bpName+'</label></div>'
                                if(idx < 15) {
                                    $(itm).appendTo('#voting_col1')
                                } else {
                                    $(itm).appendTo('#voting_col2')
                                }
                            })
                            // Register the submit callback, using local variables
                            $('#votingForm').submit(function(ev) {
                                ev.preventDefault()
                                const producers = $("#votingForm").serializeArray().map(function(elem) {
                                    return elem.value
                                })
                                // Add 'eosdacserver' to producers, if user removed one other producer
                                if(producers.length < 30) {
                                    producers.push(EOSDACSERVER)
                                }
                                castVote(api, account, producers).then(function(result) {
                                    $('#votingModal').modal('hide')
                                    succHandler(scatter, target)
                                }).catch(function(err) {
                                    $('#votingModal').modal('hide')
                                    errHandler(scatter, target, originalContent, err)
                                })
                            })
                            // Register the modal's Cancel/Hide handler, using local variables
                            $('#votingModal').on('hide.bs.modal', function (e) {
                                errHandler(scatter, target, originalContent, 'Modal cancelled/hidden.')
                            })
                            // Show the voting modal
                            $('#votingModal').modal('show')
                        }
                    }
                }).catch(function(err) {
                    errHandler(scatter, target, originalContent, err)
                })
            }
        }).catch(function(err) {
            errHandler(scatter, target, originalContent, err)
        })
    }).catch(function(err) {
        errHandler({ logout: function() { /* Scatter not signed in */ }}, target, originalContent, err)
    })
}

function adoptAuthenticatorByUseragent(idx, obj) {
    const originalContent = obj.textContent
    if(originalContent.includes('Scatter')) {
        const UA = window.navigator.userAgent
        // Detect EOS Lynx according to: https://developers.eoslynx.com/mobile
        if(UA === 'EOSLynx IOS' || UA === 'EOSLynx Android') {
            obj.textContent = originalContent.replace('Scatter', 'EOS Lynx')
            console.info('Adopted for EOSLynx.')
        }
    }
}

$(document).ready(function() {
    ScatterJS.plugins( new ScatterEOS(), new ScatterLynx({ Api: eosjs_api.Api, JsonRpc: eosjs_jsonrpc.JsonRpc }) )
    ScatterJS.scatter.connect('eosDAC.io').then(function( connected ) {
        if(!connected) {
            console.error('Scatter could not be found.')
            return false
        }

        // Scatter was successfully connected
        const scatter = ScatterJS.scatter
        //window.ScatterJS = null
        console.info('Scatter connected.')

        // Setup the click handler for '.scatter-vote-oneclick' links
        // and prevent their default (fallback) link/button behaviour,
        // i.e. do not follow their 'href'
        $('.scatter-vote-oneclick').click(function(ev) {
            ev.preventDefault()
            const target = ev.target
            const originalContent = target.textContent
            oneClickVote(scatter, target, originalContent)
        })
        console.info('Scatter handler registered.')

        // Adopt 'Vote using Scatter' button to 'Vote using EOS Lynx' if applicable
        $('.scatter-vote-oneclick').each(adoptAuthenticatorByUseragent)
    })
})
</script>
</body>

</html>
